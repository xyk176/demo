<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.demo.model.mdao.ChecksMapper">
  <resultMap id="BaseResultMap" type="com.demo.pojo.Checks">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="cheid" jdbcType="INTEGER" property="cheid" />
    <result column="chedate" jdbcType="TIMESTAMP" property="chedate" />
    <result column="chestate" jdbcType="INTEGER" property="chestate" />
    <result column="chebecount" jdbcType="INTEGER" property="chebecount" />
    <result column="chelosecoubt" jdbcType="INTEGER" property="chelosecoubt" />
    <result column="cheremark" jdbcType="VARCHAR" property="cheremark" />

    <collection property="checkxqs" ofType="Checkxq">
      <id column="chexqid" jdbcType="INTEGER" property="chexqid" />
      <result column="chexqcount" jdbcType="INTEGER" property="chexqcount" />
      <result column="cheblcount" jdbcType="INTEGER" property="cheblcount" />
      <association property="product" javaType="com.demo.pojo.SpProduct">
        <id column="lid" jdbcType="INTEGER" property="lid" />
        <result column="lname" jdbcType="VARCHAR" property="lname" />
        <result column="lguige" jdbcType="VARCHAR" property="lguige" />
        <result column="ldanwei" jdbcType="VARCHAR" property="ldanwei" />
        <result column="ltiaoma" jdbcType="INTEGER" property="ltiaoma" />
        <result column="lchengben" jdbcType="DECIMAL" property="lchengben" />
      </association>
    </collection>
  </resultMap>
  <select id="selectAndchecksxq" resultMap="BaseResultMap">
    /*查盘点详情*/
    select * from checks c inner join checkxq cx on c. cheid=cx.cheid
    inner join sp_product sp on cx.lid=sp.lid
    where c.cheid=#{cheid}
  </select>
  <select id="selectAndproduct" resultMap="BaseResultMap">

    /*查盘点关联单品*/
    select * from checks c inner join checkxq cx on c.cheid=cx.cheid
    inner join sp_product sp on cx.lid=sp.lid
    <where>
      <if test="cheid!=null and cheid !=''">
        and c.cheid=#{cheid}
      </if>
      <if test="lname!=null and lname!=''">
        and sp.lname like concat('%',#{lname},'%')
      </if>
      <if test="ltiaoma!=null and ltiaoma!=''">
        and sp.ltiaoma like concat('%',#{ltiaoma},'%')
      </if>
      <if test="date1!=null and date1!=''">
        and c.chedate between #{date1} and #{date2}
      </if>
    </where>
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from checks
    where cheid = #{cheid,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.demo.pojo.Checks"  useGeneratedKeys="true" keyProperty="cheid">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into checks (cheid, chedate, chestate, 
      chebecount, chelosecoubt, cheremark
      )
    values (#{cheid,jdbcType=INTEGER}, #{chedate,jdbcType=TIMESTAMP}, #{chestate,jdbcType=INTEGER}, 
      #{chebecount,jdbcType=INTEGER}, #{chelosecoubt,jdbcType=INTEGER}, #{cheremark,jdbcType=VARCHAR}
      )
  </insert>
  <update id="updateByPrimaryKey" parameterType="com.demo.pojo.Checks">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update checks
    set chedate = #{chedate,jdbcType=TIMESTAMP},
      chestate = #{chestate,jdbcType=INTEGER},
      chebecount = #{chebecount,jdbcType=INTEGER},
      chelosecoubt = #{chelosecoubt,jdbcType=INTEGER},
      cheremark = #{cheremark,jdbcType=VARCHAR}
    where cheid = #{cheid,jdbcType=INTEGER}
  </update>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select cheid, chedate, chestate, chebecount, chelosecoubt, cheremark
    from checks
    where cheid = #{cheid,jdbcType=INTEGER}
  </select>
  <select id="selectAll" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select cheid, chedate, chestate, chebecount, chelosecoubt, cheremark
    from checks
  </select>
</mapper>